<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
<link rel="stylesheet" type="text/css"
	href="../static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" href="../layui/css/layui.css">
<link rel="stylesheet" href="../layer/theme/default/layer.css">
<link rel="stylesheet" href="../css/attdence.css">
<script type="text/javascript" src="../layui/layui.js"></script>
<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script>
<script src="../js/jquery.webcam.js"></script>
<script src="../layer/layer.js"></script>
</head>
<body>
<div class="page-container">
	
	<form class="layui-form" action="" method="post" style="" >
		<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">假期开始时间：</label>
				<div class="layui-input-inline">
					<input name="startDate" class="layui-input" id="test5"
						placeholder="yyyy-MM-dd HH:mm:ss" type="text" autocomplete="off">
				</div>
			</div>
			</div>
			<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">假期结束时间：</label>
				<div class="layui-input-inline">
					<input name="endDate" class="layui-input" id="test6"
						placeholder="yyyy-MM-dd HH:mm:ss" type="text" autocomplete="off">
				</div>
			</div>
		</div>
			<div class="layui-form-item">
				<label class="layui-form-label">描述：</label>
				<div class="layui-input-block">
					<input  name="description" lay-verify="required" autocomplete="off"
						placeholder="" class="layui-input" type="text">
				</div>
			</div>
              <input name="type" value="1" style="display: none">
			<div  class="layui-form-item">
					<div class="layui-input-block" style="margin-top: 20px;">
						<button class="layui-btn" lay-submit="" lay-filter="insertEmp">设置假期时间</button>
					</div>
				</div>
	</form>
	<div style="margin-left: 420px; margin-top: -290px;" >
<table class="layui-table" lay-data="{width: 540, height:300, url:'/LTManage/attence/queryVacationDays?type=1', page:true, id:'idTest'}" lay-filter="demo">
  <thead>
    <tr>
      <th lay-data="{field:'description', width:100}">描述</th>
      <th lay-data="{field:'startDate', width:160}">开始时间</th>
      <th lay-data="{field:'endDate', width:160}">结束时间</th>
         <th lay-data="{fixed: 'right', width:100, align:'center', toolbar: '#barDemo'}"></th>
    </tr>
  </thead>
</table>
	</div>
 <span>--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
	<form class="layui-form" action="" method="post" style="" >
		<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">必须上班开始时间：</label>
				<div class="layui-input-inline">
					<input name="startDate" class="layui-input" id="test7"
						placeholder="yyyy-MM-dd HH:mm:ss" type="text" autocomplete="off">
				</div>
			</div>
			</div>
			<div class="layui-form-item">
			<div class="layui-inline">
				<label class="layui-form-label">必须上班结束时间：</label>
				<div class="layui-input-inline">
					<input name="endDate" class="layui-input" id="test8"
						placeholder="yyyy-MM-dd HH:mm:ss" type="text" autocomplete="off">
				</div>
			</div>
		</div>
<div class="layui-form-item">
				<label class="layui-form-label">描述：</label>
				<div class="layui-input-block">
					<input name="description" lay-verify="title" autocomplete="off"
						placeholder="" class="layui-input" type="text">
				</div>
			</div>
			  <input name="type" value="0" style="display: none">
		<div class="layui-form-item">
			<div class="layui-input-block" style="margin-top: 20px;">
				<button class="layui-btn" lay-submit="" lay-filter="insertMust">设置必须上班时间</button>
			</div>
		</div>
	</form>
		<div style="margin-left: 420px; margin-top: -260px;" >
<table class="layui-table" lay-data="{width: 540, height:300, url:'/LTManage/attence/queryVacationDays?type=0', page:true, id:'idTest2'}" lay-filter="demo2">
  <thead>
    <tr>
      <th lay-data="{field:'description', width:100}">描述</th>
      <th lay-data="{field:'startDate', width:160}">开始时间</th>
      <th lay-data="{field:'endDate', width:160}">结束时间</th>
      <th lay-data="{fixed: 'right', width:100, align:'center', toolbar: '#barDemo2'}"></th>
    </tr>
  </thead>
</table>
	</div>
	</div>
</body>
<script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script type="text/html" id="barDemo2">
  <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script>
var curWwwPath = window.document.location.href;
var pathName = window.document.location.pathname;
var pos = curWwwPath.indexOf(pathName);
var localhostPath = curWwwPath.substring(0, pos);
var projectName = pathName.substring(0, pathName.substr(1).indexOf('/') + 1);
var basePath=localhostPath+projectName+"/";



	layui.use('laydate', function() {
		 var laydate = layui.laydate;
		  
		//时间选择器
		laydate.render({
			elem : '#test5',
			type : 'datetime'
		});
		laydate.render({
			elem : '#test6',
			type : 'datetime'
		});
		laydate.render({
			elem : '#test7',
			type : 'datetime'
		});
		laydate.render({
			elem : '#test8',
			type : 'datetime'
		});
		
	});

	layui.use([ 'form' ], function() {
		var form = layui.form
		//监听提交
		form.on('submit(insertEmp)', function(data) {
			var dataobj = JSON.parse(JSON.stringify(data.field));
				console.log(JSON.stringify(data.field))
				$.ajax({
					type : 'post',
					url : basePath + 'attence/addVacationDays',
					data : {
						'data' : JSON.stringify(data.field),
					},
					dataType : "json",
					success : function(data_re) {
						var  re_value = JSON.parse(JSON.stringify(data_re));
						if(re_value.code==1){
							layer.msg('设置成功', {time:1000}, function(){
		        	    		window.location.reload();
		        	    		});
						}else{
							layer.msg("设置失败")
						}
						
					},
					error : function(msg) {
						layer.msg("服务器偷懒了")
					}
				});

			return false;
		});
		
		//监听提交
		form.on('submit(insertMust)', function(data) {
			var dataobj = JSON.parse(JSON.stringify(data.field));
				console.log(JSON.stringify(data.field))
				$.ajax({
					type : 'post',
					url : basePath + 'attence/addVacationDays',
					data : {
						'data' : JSON.stringify(data.field),
					},
					dataType : "json",
					success : function(data_re) {
						var  re_value = JSON.parse(JSON.stringify(data_re));
						if(re_value.code==1){
							layer.msg("设置成功",{time:1000}, function(){
		        	    		window.location.reload();
	        	    		});
						}
						
					},
					error : function(msg) {
						layer.msg("服务器偷懒了")
					}
				});

			return false;
		});
	});

	
	layui.use('table', function(){
		  var table = layui.table;
		  //监听工具条
		  table.on('tool(demo)', function(obj){
		    var data = obj.data;
		    if(obj.event === 'detail'){
		      layer.msg('ID：'+ data.id + ' 的查看操作');
		    } else if(obj.event === 'del'){
		      layer.confirm('真的删除行么', function(index){
		        obj.del();
		        layer.close(index);
		      
		        $.ajax({
					type : 'post',
					url : basePath + 'attence/deleteVacationDay',
					data : {
						'data' : data.id,
					},
					dataType : "json",
					success : function(data_re) {
						var  re_value = JSON.parse(JSON.stringify(data_re));
						if(re_value.code==1){
							layer.msg("删除成功",{time:1000}, function(){
		        	    		window.location.reload();
	        	    		});
						}
						
					},
					error : function(msg) {
						layer.msg("服务器偷懒了")
					}
				});
		      });
		    } else if(obj.event === 'edit'){
		      layer.alert('编辑行：<br>'+ JSON.stringify(data))
		    }
		  });
		  $('.demoTable .layui-btn').on('click', function(){
		    var type = $(this).data('type');
		    active[type] ? active[type].call(this) : '';
		  });
		});
	
	
	layui.use('table', function(){
		  var table = layui.table;
		  //监听工具条
		  table.on('tool(demo2)', function(obj){
		    var data = obj.data;
		    if(obj.event === 'detail'){
		      layer.msg('ID：'+ data.id + ' 的查看操作');
		    } else if(obj.event === 'del'){
		      layer.confirm('真的删除行么', function(index){
		        obj.del();
		        layer.close(index);
		        $.ajax({
					type : 'post',
					url : basePath + 'attence/deleteVacationDay',
					data : {
						'data' : data.id,
					},
					dataType : "json",
					success : function(data_re) {
						var  re_value = JSON.parse(JSON.stringify(data_re));
						if(re_value.code==1){
							layer.msg("删除成功",{time:1000}, function(){
		        	    		window.location.reload();
	        	    		});
						}
						
					},
					error : function(msg) {
						layer.msg("服务器偷懒了")
					}
				});
		      });
		    } else if(obj.event === 'edit'){
		      layer.alert('编辑行：<br>'+ JSON.stringify(data))
		    }
		  });
		  $('.demoTable .layui-btn').on('click', function(){
		    var type = $(this).data('type');
		    active[type] ? active[type].call(this) : '';
		  });
		});
</script>

</html>